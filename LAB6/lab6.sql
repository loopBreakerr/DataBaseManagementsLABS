CREATE DATABASE IF NOT EXISTS LAB6;

USE LAB6;

CREATE TABLE IF NOT EXISTS Customer(
	NAME VARCHAR(50) PRIMARY KEY,
    ADDRESS VARCHAR(50),
    STATE VARCHAR(50),
    ZIP INT,
	PHONE VARCHAR(50),
    REMARKS VARCHAR(50)
);

CREATE TABLE IF NOT EXISTS Part(
	PARTNUM INT PRIMARY KEY,
    DESCRIPTION VARCHAR(50),
    PRICE DOUBLE(7,2)
);

CREATE TABLE IF NOT EXISTS Orders(
	ORDEREDON VARCHAR(50),
    NAME VARCHAR(50),
    PARTNUM INT,
    QUANTITY INT,
    REMARKS VARCHAR(50),
    PRIMARY KEY(ORDEREDON,NAME,PARTNUM)
);

INSERT INTO Customer(NAME,ADDRESS,STATE,ZIP,PHONE,REMARKS) VALUES("TRUE WHEEL","550 HUSKER","NE",58702,"555-4545","NONE");
INSERT INTO Customer(NAME,ADDRESS,STATE,ZIP,PHONE,REMARKS) VALUES("BIKE SPEC","CPT SHRIVE","LA",45678,"555-1234","NONE");
INSERT INTO Customer(NAME,ADDRESS,STATE,ZIP,PHONE,REMARKS) VALUES("LE SHOPPE","HOMETOWN","KS",54678,"555-1278","NONE");
INSERT INTO Customer(NAME,ADDRESS,STATE,ZIP,PHONE,REMARKS) VALUES("AAA BIKE","10 OLDTOWN","NE",56784,"555-3421","JOHN-MGR");
INSERT INTO Customer(NAME,ADDRESS,STATE,ZIP,PHONE,REMARKS) VALUES("JACKS BIKE","24 EGLIN","FL",34567,"555-2314","NONE");


INSERT INTO Part VALUES(54,"PEDALS",54.25);
INSERT INTO Part VALUES(42,"SEATS",24.50);
INSERT INTO Part VALUES(46,"TIRES",15.25);
INSERT INTO Part VALUES(23,"MOUNTAIN BIKE",350.45);
INSERT INTO Part VALUES(76,"ROAD BIKE",530.00);
INSERT INTO Part VALUES(10,"TANDEM",1200.00);


INSERT INTO Orders VALUES("15-MAY-1996","TRUE WHEEL",23,6,"PAID");
INSERT INTO Orders VALUES("19-MAY-1996","TRUE WHEEL",76,3,"PAID");
INSERT INTO Orders VALUES("2-SEP-1996","TRUE WHEEL",10,1,"PAID");
INSERT INTO Orders VALUES("30-JUN-1996","TRUE WHEEL",42,8,"PAID");
INSERT INTO Orders VALUES("30-JUN-1996","BIKE SPEC",54,10,"PAID");
INSERT INTO Orders VALUES("30-MAY-1996","BIKE SPEC",10,2,"PAID");
INSERT INTO Orders VALUES("30-MAY-1996","BIKE SPEC",23,8,"PAID");
INSERT INTO Orders VALUES("17-JAN-1996","BIKE SPEC",76,11,"PAID");
INSERT INTO Orders VALUES("17-JAN-1996","LE SHOPPE",76,5,"PAID");
INSERT INTO Orders VALUES("1-JUN-1996","LE SHOPPE",10,3,"PAID");
INSERT INTO Orders VALUES("1-JUN-1996","AAA BIKE",10,1,"PAID");
INSERT INTO Orders VALUES("1-JUL-1996","AAA BIKE",76,4,"PAID");
INSERT INTO Orders VALUES("1-JUL-1996","AAA BIKE",46,14,"PAID");
INSERT INTO Orders VALUES("11-JUL-1996","JACKS BIKE",76,14,"PAID");




SELECT SUM(O.QUANTITY * P.PRICE) AS Total_Amount
FROM Part P JOIN Orders O ON P.PARTNUM=O.PARTNUM;


SELECT O.NAME,SUM(O.QUANTITY * P.PRICE) AS Amount
FROM Part P JOIN Orders O ON P.PARTNUM=O.PARTNUM
GROUP BY O.NAME;


SELECT P.DESCRIPTION,SUM(O.QUANTITY) AS NUMBERS
FROM Part P JOIN Orders O ON P.PARTNUM=O.PARTNUM
GROUP BY P.PARTNUM;


SELECT P.DESCRIPTION,SUM(O.QUANTITY * P.PRICE) AS Amount
FROM Part P JOIN Orders O ON P.PARTNUM=O.PARTNUM
WHERE P.PARTNUM=23;


SELECT C.NAME, C.ADDRESS, SUM(O.QUANTITY * P.PRICE) AS TOTAL, P.DESCRIPTION
FROM Orders O JOIN Customer C ON O.NAME=C.NAME
JOIN Part P ON O.PARTNUM=P.PARTNUM
GROUP BY C.NAME, P.DESCRIPTION
ORDER BY C.NAME;


SELECT O.ORDEREDON,O.NAME,O.PARTNUM,O.QUANTITY
FROM Orders O WHERE O.NAME="TRUE WHEEL" AND O.PARTNUM=10;







